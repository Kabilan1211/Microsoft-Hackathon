<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Robo-Doc</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<style>
:root {
    --body-bg: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    --msger-bg: #fff;
    --border: 2px solid #ddd;
    --left-msg-bg: #ececec;
    --right-msg-bg: #579ffb;
  }
  
  html {
    box-sizing: border-box;
  }
  
  *,
  *:before,
  *:after {
    margin: 0;
    padding: 0;
    box-sizing: inherit;
  }
  
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-image: var(--body-bg);
    font-family: Helvetica, sans-serif;
  }
  
  .msger {
    display: flex;
    flex-flow: column wrap;
    justify-content: space-between;
    width: 100%;
    max-width: 867px;
    margin: 25px 10px;
    height: calc(100% - 50px);
    border: var(--border);
    border-radius: 5px;
    background: var(--msger-bg);
    box-shadow: 0 15px 15px -5px rgba(0, 0, 0, 0.2);
  }
  
  .msger-header {
    /* display: flex; */
    font-size: medium;
    justify-content: space-between;
    padding: 10px;
    text-align: center;
    border-bottom: var(--border);
    background: #eee;
    color: #666;
  }
  
  .msger-chat {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
  }
  .msger-chat::-webkit-scrollbar {
    width: 6px;
  }
  .msger-chat::-webkit-scrollbar-track {
    background: #ddd;
  }
  .msger-chat::-webkit-scrollbar-thumb {
    background: #bdbdbd;
  }
  .msg {
    display: flex;
    align-items: flex-end;
    margin-bottom: 10px;
  }
  
  .msg-img {
    width: 50px;
    height: 50px;
    margin-right: 10px;
    background: #ddd;
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
    border-radius: 50%;
  }
  .msg-bubble {
    max-width: 450px;
    padding: 15px;
    border-radius: 15px;
    background: var(--left-msg-bg);
  }
  .msg-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  .msg-info-name {
    margin-right: 10px;
    font-weight: bold;
  }
  .msg-info-time {
    font-size: 0.85em;
  }
  
  .left-msg .msg-bubble {
    border-bottom-left-radius: 0;
  }
  
  .right-msg {
    flex-direction: row-reverse;
  }
  .right-msg .msg-bubble {
    background: var(--right-msg-bg);
    color: #fff;
    border-bottom-right-radius: 0;
  }
  .right-msg .msg-img {
    margin: 0 0 0 10px;
  }
  
  .msger-inputarea {
    display: flex;
    padding: 10px;
    border-top: var(--border);
    background: #eee;
  }
  .msger-inputarea * {
    padding: 10px;
    border: none;
    border-radius: 3px;
    font-size: 1em;
  }
  .msger-input {
    flex: 1;
    background: #ddd;
  }
  .msger-send-btn {
    margin-left: 10px;
    background: rgb(0, 196, 65);
    color: #fff;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.23s;
  }
  .msger-send-btn:hover {
    background: rgb(0, 180, 50);
  }
  
  .msger-chat {
    background-color: #fcfcfe;
  }
  .symptom-input {
    margin-bottom: 10px;
}
.option {
    background-color: #4CAF50; /* Green background */
    border: none;
    color: white;
    padding: 10px 10px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
    margin: 2px 2px;
    cursor: pointer;
    border-radius: 2px;
}

.option:hover {
    background-color: #45a049; /* Darker green when hovering */
}
/* Form styles */
form {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    background-color: #fff;
    border: 1px solid #ddd;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

label {
    margin-bottom: 8px;
    font-weight: bold;
}

input[type="text"],
select {
    width: calc(100% - 20px);
    margin-bottom: 15px;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 3px;
    font-size: 1em;
}

select {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg fill='none' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z' fill='%23212121'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position-x: calc(100% - 10px);
    background-position-y: 50%;
    padding-right: 30px; /* Adjust as needed based on arrow icon size */
}

button[type="submit"],
button[type="button"] {
    padding: 10px 20px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 3px;
    font-size: 1em;
    cursor: pointer;
    transition: background-color 0.3s;
}

button[type="submit"]:hover,
button[type="button"]:hover {
    background-color: #45a049; /* Darker shade when hovering */
}

</style>
<body>
    <section class="msger">
        <header class="msger-header">
            <div class="msger-header-title">
                DOCTORS AID
            </div>
        </header>

        <main class="msger-chat">
            <!-- Initial message from Robo-Doc -->
            <div class="msg left-msg">
                <div class="msg-img" style="background-image: url(https://image.flaticon.com/icons/svg/327/327779.svg)"></div>
                <div class="msg-bubble">
                    <div class="msg-info">
                        <div class="msg-info-name">Doctors Aid</div>
                    </div>
                    <div class="msg-text">
                        Hello, my name is Robo-Doc, and I will be happy to help diagnose your disease. Select what you wanna do!
                    </div>
                    <br>
                    <div id="buttonGroup">
                        <button class="option" onclick="selectOption('option1')">Predict disease</button>
                        <button class="option" onclick="selectOption('option2')">My meetings</button>
                        <button class="option" onclick="selectOption('option3')">Symptoms precaution</button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Chatbot response and input area -->
        <form class="msger-inputarea" onsubmit="sendMessage(event)">
            <input type="text" class="msger-input" id="textInput" placeholder="Enter your message...">
            <button type="submit" class="msger-send-btn">Send</button>
        </form>
    </section>

    <script>
        const msgerChat = document.querySelector('.msger-chat');
        const BOT_IMG = "https://image.flaticon.com/icons/svg/327/327779.svg";
        const PERSON_IMG = "https://image.flaticon.com/icons/svg/145/145867.svg";
        const BOT_NAME = "Robo-Doc";
        const PERSON_NAME = "You";

        // Function to handle option selection
        function selectOption(selected) {
            if (selected === "option1") {
                appendMessage(BOT_NAME, BOT_IMG, "left", "Sure! Please select the symptoms below.");

                // Generate the symptom form HTML
                const formHTML = `
                    <form id="symptomForm" onsubmit = "handleSubmit()">
                        <div id="symptomInputs">
                            <div class="symptom-input">
                                <label for="symptom1">Symptom 1:</label>
                                <select name="symptom1" id="symptom1"></select>
                            </div>
                            <div class="symptom-input">
                                <label for="symptom2">Symptom 2:</label>
                                <select name="symptom2" id="symptom2"></select>
                            </div>
                            <div class="symptom-input">
                                <label for="symptom3">Symptom 3:</label>
                                <select name="symptom3" id="symptom3"></select>
                            </div>
                        </div>
                        <button type="button" onclick="addSymptomInput()">Add Symptom</button>
                        <br>
                        <button type="submit">Submit</button>
                    </form>
                `;

                appendMessage(BOT_NAME, BOT_IMG, "left", formHTML);

                // Populate symptom dropdowns after appending the form
                populateSymptomDropdowns();
            }
            else if (selected === "option2") {
                appendMessage(BOT_NAME, BOT_IMG, "left", "Currently no meeting have been updated in the database.");
            }
            else if (selected === "option3") {
                appendMessage(BOT_NAME, BOT_IMG, "left", "Sure, here is the result.<br>");
            }
        }

        // Function to populate symptoms dropdowns
        function populateSymptomDropdowns() {
            const symptomInputsDiv = document.getElementById('symptomInputs');
            if (!symptomInputsDiv) {
                console.error("Element with ID 'symptomInputs' not found.");
                return;
            }

            const symptomDropdowns = symptomInputsDiv.querySelectorAll('select');
            const symptomsList = [
                'None','itching', 'skin rash', 'nodal skin eruptions',
       'continuous sneezing', 'shivering', 'chills', 'joint pain',
       'stomach pain', 'acidity', 'ulcers on tongue', 'muscle wasting',
       'vomiting', 'burning micturition', 'spotting urination', 'fatigue',
       'weight gain', 'anxiety', 'cold hands and feets', 'mood swings',
       'weight loss', 'restlessness', 'lethargy', 'patches in throat',
       'irregular sugar level', 'cough', 'high fever', 'sunken eyes',
       'breathlessness', 'sweating', 'dehydration', 'indigestion',
       'headache', 'yellowish skin', 'dark urine', 'nausea',
       'loss of appetite', 'pain behind the eyes', 'back pain',
       'constipation', 'abdominal pain', 'diarrhoea', 'mild fever',
       'yellow urine', 'yellowing of eyes', 'acute liver failure',
       'fluid overload', 'swelling of stomach', 'swelled lymph nodes',
       'malaise', 'blurred and distorted vision', 'phlegm',
       'throat irritation', 'redness of eyes', 'sinus pressure',
       'runny nose', 'congestion', 'chest pain', 'weakness in limbs',
       'fast heart rate', 'pain during bowel movements',
       'pain in anal region', 'bloody stool', 'irritation in anus',
       'neck pain', 'dizziness', 'cramps', 'bruising', 'obesity',
       'swollen legs', 'swollen blood vessels', 'puffy face and eyes',
       'enlarged thyroid', 'brittle nails', 'swollen extremeties',
       'excessive hunger', 'extra marital contacts',
       'drying and tingling lips', 'slurred speech', 'knee pain',
       'hip joint pain', 'muscle weakness', 'stiff neck',
       'swelling joints', 'movement stiffness', 'spinning movements',
       'loss of balance', 'unsteadiness', 'weakness of one body side',
       'loss of smell', 'bladder discomfort', 'foul smell ofurine',
       'continuous feel of urine', 'passage of gases', 'internal itching',
       'toxic look (typhos)', 'depression', 'irritability', 'muscle pain',
       'altered sensorium', 'red spots over body', 'belly pain',
       'abnormal menstruation', 'dischromic patches',
       'watering from eyes', 'increased appetite', 'polyuria',
       'family history', 'mucoid sputum', 'rusty sputum',
       'lack of concentration', 'visual disturbances',
       'receiving blood transfusion', 'receiving unsterile injections',
       'coma', 'stomach bleeding', 'distention of abdomen',
       'history of alcohol consumption', 'blood in sputum',
       'prominent veins on calf', 'palpitations', 'painful walking',
       'pus filled pimples', 'blackheads', 'scurring', 'skin peeling',
       'silver like dusting', 'small dents in nails',
       'inflammatory nails', 'blister', 'red sore around nose',
       'yellow crust ooze', 'prognosis'
            ];

            symptomDropdowns.forEach(function(selectElement) {
                symptomsList.forEach(function(symptom) {
                    const option = document.createElement('option');
                    option.value = symptom;
                    option.textContent = symptom;
                    selectElement.appendChild(option);
                });
            });
        }

        // Function to add a new symptom input field
        function addSymptomInput() {
            const symptomInputsDiv = document.getElementById('symptomInputs');
            const symptomCount = symptomInputsDiv.childElementCount; // Count current symptom inputs

            if (symptomCount >= 17) {
                alert("You have reached the maximum number of symptoms (17).");
                return;
            }

            const newSymptomIndex = symptomCount + 1;

            // Create new symptom input field
            const newDiv = document.createElement('div');
            newDiv.classList.add('symptom-input');
            newDiv.innerHTML = `
                <label for="symptom${newSymptomIndex}">Symptom ${newSymptomIndex}:</label>
                <select name="symptom${newSymptomIndex}" id="symptom${newSymptomIndex}"></select>
            `;

            symptomInputsDiv.appendChild(newDiv); // Append new symptom input field


            // Populate the new dropdown with symptoms
            const newSelect = newDiv.querySelector(`#symptom${newSymptomIndex}`);
            const symptomsList = [
            'None','itching', 'skin rash', 'nodal skin eruptions',
       'continuous sneezing', 'shivering', 'chills', 'joint pain',
       'stomach pain', 'acidity', 'ulcers on tongue', 'muscle wasting',
       'vomiting', 'burning micturition', 'spotting urination', 'fatigue',
       'weight gain', 'anxiety', 'cold hands and feets', 'mood swings',
       'weight loss', 'restlessness', 'lethargy', 'patches in throat',
       'irregular sugar level', 'cough', 'high fever', 'sunken eyes',
       'breathlessness', 'sweating', 'dehydration', 'indigestion',
       'headache', 'yellowish skin', 'dark urine', 'nausea',
       'loss of appetite', 'pain behind the eyes', 'back pain',
       'constipation', 'abdominal pain', 'diarrhoea', 'mild fever',
       'yellow urine', 'yellowing of eyes', 'acute liver failure',
       'fluid overload', 'swelling of stomach', 'swelled lymph nodes',
       'malaise', 'blurred and distorted vision', 'phlegm',
       'throat irritation', 'redness of eyes', 'sinus pressure',
       'runny nose', 'congestion', 'chest pain', 'weakness in limbs',
       'fast heart rate', 'pain during bowel movements',
       'pain in anal region', 'bloody stool', 'irritation in anus',
       'neck pain', 'dizziness', 'cramps', 'bruising', 'obesity',
       'swollen legs', 'swollen blood vessels', 'puffy face and eyes',
       'enlarged thyroid', 'brittle nails', 'swollen extremeties',
       'excessive hunger', 'extra marital contacts',
       'drying and tingling lips', 'slurred speech', 'knee pain',
       'hip joint pain', 'muscle weakness', 'stiff neck',
       'swelling joints', 'movement stiffness', 'spinning movements',
       'loss of balance', 'unsteadiness', 'weakness of one body side',
       'loss of smell', 'bladder discomfort', 'foul smell ofurine',
       'continuous feel of urine', 'passage of gases', 'internal itching',
       'toxic look (typhos)', 'depression', 'irritability', 'muscle pain',
       'altered sensorium', 'red spots over body', 'belly pain',
       'abnormal menstruation', 'dischromic patches',
       'watering from eyes', 'increased appetite', 'polyuria',
       'family history', 'mucoid sputum', 'rusty sputum',
       'lack of concentration', 'visual disturbances',
       'receiving blood transfusion', 'receiving unsterile injections',
       'coma', 'stomach bleeding', 'distention of abdomen',
       'history of alcohol consumption', 'blood in sputum',
       'prominent veins on calf', 'palpitations', 'painful walking',
       'pus filled pimples', 'blackheads', 'scurring', 'skin peeling',
       'silver like dusting', 'small dents in nails',
       'inflammatory nails', 'blister', 'red sore around nose',
       'yellow crust ooze', 'prognosis'
            ];

            symptomsList.forEach(function(symptom) {
                const option = document.createElement('option');
                option.value = symptom;
                option.textContent = symptom;
                newSelect.appendChild(option);
            });
        }

        function handleSubmit(event) {
    event.preventDefault();

    // Collect symptom data from the form
    const symptomData = {
        symptoms: []
    };

    const symptomInputs = document.querySelectorAll('.symptom-input select');
    symptomInputs.forEach(function(selectElement) {
        const symptomValue = selectElement.value;
        symptomData.symptoms.push(symptomValue);
    });

    // Example: Send symptomData to your server or process it locally
    console.log("Symptom Data:", symptomData);

    // Reset form or perform further actions as needed
    event.target.reset();

    // Assuming 'symptoms' is an array containing selected symptoms
    $.get('/predict', { msg: symptomData.symptoms }).done(function (data) {
        console.log(symptomData.symptoms);
        console.log(data);
        const msgText = data;
        appendMessage(BOT_NAME, BOT_IMG, "left", msgText);

      });

}

        // Function to append a message to the chat
function appendMessage(name, img, side, text) {
    const msgHTML = `
        <div class="msg ${side}-msg">
            <div class="msg-img" style="background-image: url(${img})"></div>
            <div class="msg-bubble">
                <div class="msg-info">
                    <div class="msg-info-name">${name}</div>
                    <div class="msg-info-time">${formatDate(new Date())}</div>
                </div>
                <div class="msg-text">${text}</div>
            </div>
        </div>
    `;
    msgerChat.insertAdjacentHTML("beforeend", msgHTML);
    msgerChat.scrollTop = msgerChat.scrollHeight;
}

// Function to handle bot responses
function botResponse(rawText) {
    // Simulating a server response (replace with actual server call)
    const msgText = `Robo-Doc: please select any one in the above options  "${rawText}".`;
    appendMessage(BOT_NAME, BOT_IMG, "left", msgText);

    // AJAX request to send the message to Flask backend
    $.ajax({
        type: "POST",
        url: "/send_message",
        data: { message: rawText },
        success: function(response) {
            appendMessage(BOT_NAME, BOT_IMG, "left", response.message);
        },
        error: function(error) {
            console.error("Error sending message:", error);
        }
    });
}

        function sendMessage(event) {
            event.preventDefault();
            const msgText = document.getElementById('textInput').value.trim();
            if (!msgText) return;

            appendMessage(PERSON_NAME, PERSON_IMG, "right", msgText);
            document.getElementById('textInput').value = "";
            appendMessage(BOT_NAME, BOT_IMG, "left", "Sorry select any one of the above options")
        }

        function formatDate(date) {
            const h = "0" + date.getHours();
            const m = "0" + date.getMinutes();
            return `${h.slice(-2)}:${m.slice(-2)}`;
        }
    </script>

</body>
</html>
